/*---------------------------------------------------------------------------*\
        .-''''-.         |
       /        \        |
      /_        _\       |  SpaceHub: The Open Source N-body Toolkit
     // \  <>  / \\      |
     |\__\    /__/|      |  Website:  https://yihanwangastro.github.io/SpaceHub/
      \    ||    /       |
        \  __  /         |  Copyright (C) 2019 Yihan Wang
         '.__.'          |
---------------------------------------------------------------------
License
    This file is part of SpaceHub.
    SpaceHub is free software: you can redistribute it and/or modify it under
    the terms of the GPL-3.0 License. SpaceHub is distributed in the hope that it
    will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty
    of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GPL-3.0 License
    for more details. You should have received a copy of the GPL-3.0 License along
    with SpaceHub.
\*---------------------------------------------------------------------------*/
/**
 * @file axis-symmetric.hpp
 *
 * Header file.
 */
#pragma once

#include "../dev-tools.hpp"
#include "../macros.hpp"
#include "../spacehub-concepts.hpp"
namespace hub::force {
    static const std::vector<double> _GDF_I = {
        0.03353477310756164,    0.034734392236140756,   0.035978060412398705,   0.03726752096204775,
        0.03860460002519508,    0.03999121194153265,    0.04142936512106664,    0.0429211684550382,
        0.04446883832868869,    0.04607470630560932,    0.047741227562810094,   0.04947099016618135,
        0.05126672528842926,    0.05313131848582874,    0.05506782216647487,    0.05707946940199091,
        0.05916968925689883,    0.061342123835764206,   0.06360064727874257,    0.06594938697192382,
        0.06839274728077802,    0.07093543616493195,    0.07358249509123961,    0.07633933273233864,
        0.07921176302153891,    0.08220604823514063,    0.08532894789414955,    0.08858777442301795,
        0.09199045668027518,    0.09554561269160872,    0.09926263318059157,    0.10315177781775983,
        0.10722428651200937,    0.11149250857015065,    0.11597005317893944,    0.12067196545585393,
        0.1256149333194828,     0.13081753171334742,    0.13630051236804913,    0.14208714942779635,
        0.14820365406772995,    0.1546796749237185,     0.16154890607954941,    0.16884983098320988,
        0.17662663968309775,    0.18493036919747236,    0.19382033416256078,    0.20336593942889636,
        0.2136490015102764,     0.2247667572678558,     0.23683581481874894,    0.24999741800379588,
        0.2644245764875223,     0.28033190152468235,    0.2979894594771676,     0.3177427544186304,
        0.34004235551807077,    0.36548926071408094,    0.3949310843965265,     0.42910755099962344,
        0.46785167716563225,    0.5107944640744347,     0.5574310316927122,     0.6070976892036025,
        0.6589458716177755,     0.7119125528011466,     0.764686699031609,      0.8156712757699547,
        0.8629402629989096,     0.9041900705821794,     0.9366846738813736,     0.9571937105185854,
        0.9619226907701951,     0.9464343756049196,     0.9146916130254091,     0.8783144223977222,
        0.8393776330118448,     0.7992411606891134,     0.7588360323454583,     0.7188059803762245,
        0.6795964360360272,     0.6415127771646445,     0.6047597303355582,     0.569468756209253,
        0.5357175133287014,     0.5035439501997561,     0.47295666542679543,    0.4439426204558579,
        0.4164729401120735,     0.39050731020545143,    0.3659973318135005,     0.3428890905273408,
        0.3211251290083233,     0.3006459620714377,     0.2813912384473598,     0.2633006279872549,
        0.2463144944510655,     0.23037440019517366,    0.2154234787006681,     0.2014067030205861,
        0.18827107221127232,    0.1759657331763813,     0.1644420517500296,     0.15365364402822856,
        0.14355637674047425,    0.134108343698648,      0.1252698239647623,     0.1170032262641061,
        0.10927302327604041,    0.10204567871492161,    0.0952895695325805,     0.08897490510357053,
        0.08307364487308865,    0.07755941563778661,    0.07240742937791084,    0.06759440235438549,
        0.0630984760178426,     0.058899140141142815,   0.05497715847693815,    0.05131449715269316,
        0.04789425594354464,    0.04470060250539359,    0.04171870960417609,    0.03893469534030251,
        0.036335566338102025,   0.03390916384736763,    0.031644112686623815,   0.029529772944584535,
        0.02755619434664902,    0.025714073186551438,   0.023994711718893252,   0.02238997990580438,
        0.020892279410026637,   0.019494509726984646,   0.018190036349652917,   0.01697266086202927,
        0.015836592859612714,   0.014776423598314986,   0.01378710127658665,    0.012863907859121053,
        0.012002437354224835,   0.011198575460754734,   0.010448480504360298,   0.009748565586599442,
        0.009095481874278034,   0.00848610296007478,    0.007917510229132839,   0.007386979169811624,
        0.006891966570185043,   0.006430098545139944,   0.005999159342062409,   0.005597080876099939,
        0.00522193294885121,    0.004871914107062771,   0.0045453431005065045,  0.0042406509006731674,
        0.0039563732442512555,  0.0036911436675690808,  0.00344368700026573,    0.003212813288428751,
        0.002997412119296185,   0.0027964473213741336,  0.00260895201547227,    0.0024340239937134236,
        0.0022708214050351947,  0.0021185587270747307,  0.001976503005618297,   0.001843970344008599,
        0.0017203226260394337,  0.0016049644569337774,  0.0014973403080009884,  0.0013969318515060245,
        0.0013032554731616098,  0.0012158599504765908,  0.0011343242859640328,  0.001058255684933386,
        0.0009872876682659431,  0.0009210783112041698,  0.0008593085997760985,  0.0008016808970285653,
        0.0007479175117596182,  0.0006977593629235683,  0.0006509647333337715,  0.0006073081067102979,
        0.0005665790825142652,  0.0005285813633792118,  0.0004931318102944252,  0.00046005956101698094,
        0.000429205207489882,   0.00040042002832459616, 0.0003735652726685521,  0.0003485114920231916,
        0.00032513791680695617, 0.00030333187467122244, 0.00028298824777671524, 0.0002640089664241957,
        0.00024630253660710614, 0.0002297835992162493,  0.00021437251877811514, 0.00019999499974998334};
    static const std::vector<double> _GDF_lgM = {-1.0,
                                                 -0.9849246231155779,
                                                 -0.9698492462311558,
                                                 -0.9547738693467337,
                                                 -0.9396984924623115,
                                                 -0.9246231155778895,
                                                 -0.9095477386934674,
                                                 -0.8944723618090452,
                                                 -0.8793969849246231,
                                                 -0.864321608040201,
                                                 -0.8492462311557789,
                                                 -0.8341708542713568,
                                                 -0.8190954773869347,
                                                 -0.8040201005025126,
                                                 -0.7889447236180904,
                                                 -0.7738693467336684,
                                                 -0.7587939698492463,
                                                 -0.7437185929648241,
                                                 -0.728643216080402,
                                                 -0.7135678391959799,
                                                 -0.6984924623115578,
                                                 -0.6834170854271358,
                                                 -0.6683417085427136,
                                                 -0.6532663316582914,
                                                 -0.6381909547738693,
                                                 -0.6231155778894473,
                                                 -0.6080402010050252,
                                                 -0.592964824120603,
                                                 -0.5778894472361809,
                                                 -0.5628140703517588,
                                                 -0.5477386934673367,
                                                 -0.5326633165829147,
                                                 -0.5175879396984925,
                                                 -0.5025125628140703,
                                                 -0.48743718592964824,
                                                 -0.4723618090452261,
                                                 -0.457286432160804,
                                                 -0.4422110552763819,
                                                 -0.42713567839195987,
                                                 -0.4120603015075377,
                                                 -0.39698492462311563,
                                                 -0.38190954773869346,
                                                 -0.3668341708542714,
                                                 -0.3517587939698493,
                                                 -0.33668341708542715,
                                                 -0.3216080402010051,
                                                 -0.3065326633165829,
                                                 -0.2914572864321609,
                                                 -0.2763819095477386,
                                                 -0.2613065326633166,
                                                 -0.2462311557788945,
                                                 -0.23115577889447236,
                                                 -0.21608040201005027,
                                                 -0.2010050251256281,
                                                 -0.18592964824120603,
                                                 -0.17085427135678397,
                                                 -0.15577889447236182,
                                                 -0.14070351758793972,
                                                 -0.12562814070351758,
                                                 -0.11055276381909553,
                                                 -0.09547738693467346,
                                                 -0.08040201005025127,
                                                 -0.06532663316582918,
                                                 -0.05025125628140704,
                                                 -0.03517587939698496,
                                                 -0.020100502512562922,
                                                 -0.005025125628140743,
                                                 0.010050251256281438,
                                                 0.02512562814070352,
                                                 0.040201005025125615,
                                                 0.05527638190954762,
                                                 0.07035175879396968,
                                                 0.08542713567839198,
                                                 0.10050251256281402,
                                                 0.11557788944723611,
                                                 0.13065326633165816,
                                                 0.14572864321608026,
                                                 0.16080402010050251,
                                                 0.17587939698492458,
                                                 0.1909547738693467,
                                                 0.2060301507537687,
                                                 0.2211055276381908,
                                                 0.23618090452261306,
                                                 0.25125628140703515,
                                                 0.2663316582914572,
                                                 0.2814070351758793,
                                                 0.29648241206030135,
                                                 0.31155778894472363,
                                                 0.3266331658291457,
                                                 0.34170854271356776,
                                                 0.35678391959798983,
                                                 0.3718592964824119,
                                                 0.3869346733668342,
                                                 0.40201005025125625,
                                                 0.4170854271356783,
                                                 0.4321608040201003,
                                                 0.44723618090452266,
                                                 0.4623115577889447,
                                                 0.4773869346733668,
                                                 0.49246231155778886,
                                                 0.5075376884422109,
                                                 0.5226130653266332,
                                                 0.5376884422110553,
                                                 0.5527638190954773,
                                                 0.5678391959798994,
                                                 0.5829145728643215,
                                                 0.5979899497487438,
                                                 0.6130653266331658,
                                                 0.6281407035175879,
                                                 0.64321608040201,
                                                 0.658291457286432,
                                                 0.6733668341708543,
                                                 0.6884422110552764,
                                                 0.7035175879396984,
                                                 0.7185929648241205,
                                                 0.7336683417085426,
                                                 0.7487437185929648,
                                                 0.7638190954773869,
                                                 0.778894472361809,
                                                 0.793969849246231,
                                                 0.8090452261306531,
                                                 0.8241206030150754,
                                                 0.8391959798994975,
                                                 0.8542713567839195,
                                                 0.8693467336683416,
                                                 0.8844221105527637,
                                                 0.8994974874371859,
                                                 0.914572864321608,
                                                 0.9296482412060301,
                                                 0.9447236180904521,
                                                 0.9597989949748742,
                                                 0.9748743718592965,
                                                 0.9899497487437185,
                                                 1.0050251256281406,
                                                 1.020100502512563,
                                                 1.0351758793969847,
                                                 1.050251256281407,
                                                 1.0653266331658289,
                                                 1.0804020100502512,
                                                 1.0954773869346734,
                                                 1.1105527638190953,
                                                 1.1256281407035176,
                                                 1.1407035175879394,
                                                 1.1557788944723617,
                                                 1.170854271356784,
                                                 1.1859296482412058,
                                                 1.2010050251256281,
                                                 1.21608040201005,
                                                 1.2311557788944723,
                                                 1.2462311557788945,
                                                 1.2613065326633164,
                                                 1.2763819095477387,
                                                 1.2914572864321605,
                                                 1.3065326633165828,
                                                 1.321608040201005,
                                                 1.336683417085427,
                                                 1.3517587939698492,
                                                 1.366834170854271,
                                                 1.3819095477386933,
                                                 1.3969849246231156,
                                                 1.4120603015075375,
                                                 1.4271356783919598,
                                                 1.4422110552763816,
                                                 1.457286432160804,
                                                 1.4723618090452262,
                                                 1.487437185929648,
                                                 1.5025125628140703,
                                                 1.5175879396984921,
                                                 1.5326633165829144,
                                                 1.5477386934673367,
                                                 1.5628140703517586,
                                                 1.5778894472361809,
                                                 1.5929648241206027,
                                                 1.608040201005025,
                                                 1.6231155778894473,
                                                 1.6381909547738691,
                                                 1.6532663316582914,
                                                 1.6683417085427132,
                                                 1.6834170854271355,
                                                 1.6984924623115578,
                                                 1.7135678391959797,
                                                 1.728643216080402,
                                                 1.7437185929648238,
                                                 1.758793969849246,
                                                 1.7738693467336684,
                                                 1.7889447236180902,
                                                 1.8040201005025125,
                                                 1.8190954773869343,
                                                 1.8341708542713566,
                                                 1.849246231155779,
                                                 1.8643216080402008,
                                                 1.879396984924623,
                                                 1.8944723618090453,
                                                 1.9095477386934672,
                                                 1.9246231155778895,
                                                 1.9396984924623113,
                                                 1.9547738693467336,
                                                 1.9698492462311559,
                                                 1.9849246231155777,
                                                 2.0};

    static const std::vector<double> _mag_disk_lgr_cgs = {
        10.848169570835784, 10.859134940659754, 10.870074926723767, 10.881024445344949, 10.89201486057357,
        10.902960824351105, 10.913932586562831, 10.924885589614927, 10.93584953080633,  10.946782718423142,
        10.957747351495597, 10.968701922991093, 10.979672130541898, 10.990619207942363, 11.001598376550799,
        11.012541808644304, 11.023502686468719, 11.034473015147212, 11.045418140670069, 11.056386299037793,
        11.067343189763033, 11.078308158407944, 11.089273885393192, 11.100233583579648, 11.111180971585332,
        11.122155880852876, 11.133105061156007, 11.14406707284579,  11.155034255291215, 11.165999496834365,
        11.176956208086006, 11.187917905354803, 11.198877500606399, 11.20982842638832,  11.220800970148407,
        11.231751357399867, 11.24272635513957,  11.253683711514125, 11.26463443035611,  11.275604340647527,
        11.286554052882085, 11.29752404504264,  11.30847638627409,  11.319449114113315, 11.330405747553595,
        11.341368290509594, 11.352329586046014, 11.363283001336885, 11.374247938779753, 11.385216827666545,
        11.396170502356474, 11.407138874434713, 11.418091050861483, 11.429055269554718, 11.440012949137856,
        11.450979250735724, 11.461936378713407, 11.472898633793685, 11.48385891662366,  11.494820322287687,
        11.505785477008327, 11.51674737656993,  11.527708501188307, 11.538670928113387, 11.549627836558274,
        11.560589540756814, 11.57155707305079,  11.582515368800047, 11.593473798201227, 11.6044406638177,
        11.615401288439617, 11.626363695446413, 11.637321029082731, 11.64828732381387,  11.6592485689324,
        11.670211327424838, 11.68116876250848,  11.692132969450066, 11.703096725339726, 11.714053334825183,
        11.725019377464438, 11.735976329948514, 11.746939791904984, 11.757902560943975, 11.768863107815829,
        11.779824908960997, 11.790786041558361, 11.801749373604363, 11.812712669638277, 11.823673741324356,
        11.83463487427951,  11.845589340559274, 11.856577176723405, 11.867539967739933, 11.878472813398043,
        11.889449203648311, 11.900421194134589, 11.91138236271205,  11.922326774842409, 11.93328420415988,
        11.944246985192802, 11.955208001237065, 11.966193332309162, 11.977130717499827, 11.988110171112153,
        11.999061284942945, 12.010038493744526, 12.02097554091249,  12.031952924041686, 12.042906182684074,
        12.053883767666619, 12.064825082063201, 12.075802241287263, 12.086756372253914, 12.09773071584566,
        12.108693515977668, 12.119638887874599, 12.130606159734352, 12.141565181622607, 12.15253111013741,
        12.163496709334314, 12.174455271636093, 12.185420314338222, 12.196384634231306, 12.207341554757887,
        12.218303184290477, 12.229262455116684, 12.240230203724364, 12.251182125111157, 12.26214572440277,
        12.273113422065032, 12.284078183714346, 12.295033493402089, 12.306003210328143, 12.31696497573512,
        12.327926850615425, 12.338882102161435, 12.349851513621276, 12.360814143954979, 12.371776602964212,
        12.382732177253837, 12.39369907428881,  12.404657829358868, 12.41562553364803,  12.426583480158525,
        12.437547736397573, 12.44851111306475,  12.459466946744339, 12.470429537620419, 12.481391666859887,
        12.492356371108444, 12.503316732602823, 12.514275595323376, 12.525244386898704, 12.536206851774612,
        12.547165300215903, 12.558130028665788, 12.569093849113667, 12.580050099412839, 12.59101587099466,
        12.601976179498044, 12.61293944079764,  12.623898712228932, 12.634861578559262, 12.645827883264708,
        12.656783980742677, 12.667749884781703, 12.678711814056324, 12.68967568575043,  12.700634629759175,
        12.711599902189624, 12.722558584825238, 12.733521188246737, 12.744486144237714, 12.755446550795766,
        12.766406369234682, 12.77736901510674,  12.788332477063209, 12.799294766266778, 12.810258600225827,
        12.821221700036292, 12.832181840619496, 12.843123840638675, 12.854088859701895, 12.865072612470259,
        12.87602675518944,  12.886985946776026, 12.897943099246671, 12.908928925064528, 12.919861863395438,
        12.930845433214062, 12.94180005508241,  12.95275482822076,  12.963735889700898, 12.974702521618994,
        12.985649043040077, 12.996600686395288, 13.007580076813376, 13.018549469798035, 13.029502856270376,
        13.040462231440577, 13.051420438477086, 13.06239702639447,  13.073358373744474, 13.084323760771083,
        13.095261889203108, 13.106239068290597, 13.117199541959486, 13.128160308710264, 13.139114624363788,
        13.150077643271901, 13.161042003902681, 13.172000879063532, 13.182967784104557, 13.193935399328872,
        13.204896937666721, 13.215864505864172, 13.226812999496447, 13.237789557148993, 13.248751286782126,
        13.259709167095082, 13.270672968821552, 13.281635531822902, 13.292590220345916, 13.303560948262454,
        13.314510502642051, 13.325476583311243, 13.336437322674346, 13.347399970327045, 13.358370905010934,
        13.369329867017125, 13.38029619406988,  13.391250337954977, 13.402210420812263, 13.413180961920755,
        13.424143075069747, 13.43510174870127,  13.446061337111557, 13.457025605726987, 13.46798748405903,
        13.47895045481132,  13.489907711508598, 13.50087203313452,  13.511836175193183, 13.522802491458508,
        13.533764090443672, 13.544723214961603, 13.555681733888772, 13.56664937008129,  13.577610728997579,
        13.588575134557013, 13.599535635149245};

    static const std::vector<double> _mag_disk_lgrho_cgs = {
        -2.71526350508578,   -2.711456477359652,  -2.7157736396180883, -2.7314689820458367, -2.7614082652385026,
        -2.8140202802923477, -2.892999970109418,  -2.997477767306345,  -3.1430203359765394, -3.3289490056862174,
        -3.5600302786958,    -3.810392751346183,  -4.13789715897176,   -4.472723437905198,  -4.927878306374829,
        -5.423508887493627,  -6.026316059781766,  -6.698102725726838,  -7.369712001630094,  -8.196178307852591,
        -9.007753313723185,  -9.776645700602844,  -10.420115015730612, -10.884938117586888, -11.248518575679457,
        -11.464584843309826, -11.608756454855792, -11.705392273686115, -11.781522562233127, -11.848171695887318,
        -11.905670197967996, -11.968589410495488, -12.027134219057324, -12.08954691806315,  -12.147054891410725,
        -12.203831386371785, -12.263676185065385, -12.320222213964374, -12.376962172487277, -12.427914906166452,
        -12.472164765992604, -12.5167344335576,   -12.548187281713131, -12.581409812710342, -12.617555484126024,
        -12.624015419629131, -12.559169319328815, -12.513171658536383, -12.58953948318934,  -12.589762190155382,
        -12.530146309752064, -12.676940654297542, -12.687094068569461, -12.690572120934448, -12.660041982275319,
        -12.688370116078323, -12.700560075635906, -12.682066402083278, -12.688489937980561, -12.635459573933968,
        -12.580225174095382, -12.561429261479114, -12.534972318584336, -12.530590402058317, -12.583380966438911,
        -12.600719224825298, -12.621988490788084, -12.600295156870716, -12.515579358640005, -12.602419649635886,
        -12.600034397642286, -12.503933248392874, -12.491676303183917, -12.50304618738613,  -12.492794898733168,
        -12.469575134225154, -12.427410969824372, -12.426426695439394, -12.471049573565185, -12.414956376988927,
        -12.348934667393193, -12.365286421110373, -12.315305844837422, -12.307493798460474, -12.252101427166231,
        -12.171973047929995, -12.180594866247604, -12.144490378134392, -12.127367484348873, -12.121319399916066,
        -12.083018002551663, -12.097351590486628, -12.076634603130998, -12.034665348177327, -12.029133869449064,
        -12.046827628894258, -12.051658622150205, -12.084208639513811, -12.064398790630715, -12.0306330857718,
        -12.006472109962434, -12.001278036831051, -11.988992964377864, -11.98668504082598,  -11.98895306850693,
        -12.002791030346115, -12.01201503599613,  -12.016251016574438, -12.005078730370995, -11.986939107074924,
        -11.973789870367508, -11.967684368561985, -11.957747461783482, -11.956657265959334, -11.927476432034975,
        -11.926321383641014, -11.936355243334152, -11.926404278768958, -11.921929917002071, -11.905564826647282,
        -11.907597729041953, -11.891314404076203, -11.874159272016215, -11.85763252730069,  -11.85912107260735,
        -11.86756943913393,  -11.884655633289698, -11.895206175686384, -11.901116532628246, -11.908312824323968,
        -11.91011238508318,  -11.921328609212134, -11.920455463225133, -11.91604166360969,  -11.914526528634248,
        -11.911618849118987, -11.899568058505098, -11.893614528816098, -11.896268375059897, -11.880775997997555,
        -11.887975418711223, -11.87622234507232,  -11.86204802443956,  -11.844969780293386, -11.84002100483459,
        -11.84188796468283,  -11.84027589077772,  -11.832537774789463, -11.828603971250788, -11.789211511855944,
        -11.766331063338054, -11.761824256153357, -11.770450724365423, -11.789750835988086, -11.783929429320336,
        -11.789201437404689, -11.784522023775942, -11.785919561585297, -11.822540778173781, -11.84167191757203,
        -11.833239624503179, -11.847554771548255, -11.84993504311809,  -11.85045674608617,  -11.859683557444304,
        -11.84526770533421,  -11.836530004311028, -11.85299301724627,  -11.87329031559795,  -11.905564826647282,
        -11.908776941703993, -11.909999278031666, -11.906091939095774, -11.907273675552881, -11.90867081399502,
        -11.908094198038484, -11.911218393136807, -11.917352303791287, -11.93263891048647,  -11.93345265605884,
        -11.939462427170918, -11.965033359795596, -11.98759878496171,  -12.012747667318752, -12.02820712240734,
        -12.036513072379028, -12.043042725601488, -12.049607825436043, -12.064370313860131, -12.091543075238599,
        -12.1210164918083,   -12.139914332759474, -12.15811446518398,  -12.183907065689528, -12.217983283996082,
        -12.252086802732983, -12.282460742079323, -12.312355635160236, -12.337747867232505, -12.354175280863462,
        -12.360511106090561, -12.374318767909468, -12.404569984985729, -12.438006206050025, -12.472383291160725,
        -12.515445246764838, -12.556036806082641, -12.579354345567193, -12.595399545569103, -12.608656727851205,
        -12.626882972467673, -12.662292606496315, -12.709397708002049, -12.744718708035974, -12.771121822389343,
        -12.794910650282837, -12.81112325428529,  -12.820917529640877, -12.830699412119529, -12.84498123517046,
        -12.858919939136232, -12.86373117655248,  -12.876480919663042, -13.07351167374179,  -13.13717820260369,
        -13.151324366992041, -13.161152204502443, -13.167918207325243, -13.171596230269483, -13.17286168634016,
        -13.17095274997841,  -13.1660788142524,   -13.158267616001792, -13.1464696738421,   -13.133078261545823,
        -13.15075653294551,  -13.240656201406654, -13.329595342343149, -13.359723423176534, -13.381410484242645,
        -13.407488361498187, -13.43121586820888,  -13.456478880486461, -13.481091795043207, -13.505843963976275,
        -13.529924433774621, -13.555242499272813, -13.579261145992765, -13.604488739068536, -13.628898102479122,
        -13.653211911190022, -13.677680342984816};

    static const std::vector<double> _mag_disk_lgH_cgs = {
        10.848075643604924, 10.859041013428895, 10.869980999492908, 10.88093051811409,  10.891920933342709,
        10.902866897120246, 10.913838659331972, 10.924791662384067, 10.935755603575469, 10.946688791192281,
        10.957653424264736, 10.968607995760234, 10.979578203311037, 10.990525280711502, 11.001504449319938,
        11.012447881413445, 11.02340875923786,  11.034379087916351, 11.04532421343921,  11.056292371806933,
        11.067249262532174, 11.078214231177084, 11.089179958162331, 11.100139656348787, 11.111087044354473,
        11.122061953622016, 11.133011133925148, 11.143973145614929, 11.154940328060354, 11.165905569603504,
        11.176862280855147, 11.187823978123943, 11.198783573375538, 11.20973449915746,  11.220707042917546,
        11.231657430169006, 11.24263242790871,  11.253589784283264, 11.264540503125252, 11.275510413416667,
        11.286460125651226, 11.29743011781178,  11.30838245904323,  11.319355186882456, 11.330311820322736,
        11.341274363278735, 11.352235658815156, 11.363189074106025, 11.374154011548892, 11.385122900435684,
        11.394759501521097, 11.398890704883932, 11.407632630714433, 11.41611635758843,  11.425771740824638,
        11.435334220560614, 11.444781787143063, 11.454119894033406, 11.462731996398743, 11.470938504827776,
        11.479801382631994, 11.4890620235943,   11.498218732814381, 11.507075944557132, 11.51552157883433,
        11.523798521418685, 11.531874867796851, 11.539666568336468, 11.547237781244112, 11.554578784923807,
        11.561886796172427, 11.569074751168825, 11.576010356859427, 11.582716309875057, 11.589465576967445,
        11.595947978227926, 11.601904109615715, 11.606738535991182, 11.611126998743186, 11.614798588944783,
        11.617839135337732, 11.617677755077358, 11.607869925123934, 11.601046390616707, 11.592961951937154,
        11.568488995032679, 11.536681618030764, 11.497787305486849, 11.469442565476122, 11.440802219930523,
        11.415641174603357, 11.372660033105847, 11.315258567836619, 11.266392433459302, 11.240596969464965,
        11.228198341994355, 11.239045911056564, 11.249944901590263, 11.260826446594812, 11.271724125213119,
        11.282625589553096, 11.29352372221557,  11.304444407773413, 11.315322374920958, 11.326241641807325,
        11.33713118021252,  11.348045079231415, 11.358917426557747, 11.369832353190018, 11.380725495208475,
        11.391641280328134, 11.402519415372074, 11.413431558298605, 11.424325461596228, 11.435238685857518,
        11.44613885993895,  11.457020098382415, 11.46792612981217,  11.47882533508974,  11.489729870228114,
        11.500632498582307, 11.511526511856326, 11.522088139626176, 11.531718435303983, 11.54130368325775,
        11.550853243008305, 11.560359649520143, 11.569830921032818, 11.579244714246025, 11.588623242138864,
        11.5979589997258,   11.607251246818254, 11.616485755482396, 11.625680907253367, 11.634816148874416,
        11.643896415177688, 11.652914262210409, 11.662481708951974, 11.673382767818795, 11.684282072900174,
        11.695172910081642, 11.706073336200532, 11.71696396067438,  11.72786172393377,  11.738749607759269,
        11.749649520020125, 11.760546902617087, 11.771435091350774, 11.78233370042203,  11.793233670065302,
        11.804134600947771, 11.81502957456551,  11.825921376817954, 11.836821319865132, 11.847713204607489,
        11.861937677101913, 11.879724694860343, 11.897570142778292, 11.915462466885558, 11.933428927928931,
        11.947889641729466, 11.958794735921233, 11.969694366671142, 11.980596038887738, 11.991499555741024,
        12.002391310525846, 12.021915255520778, 12.043618660787294, 12.065316415282307, 12.086994383286717,
        12.100901826865064, 12.113752067091413, 12.126646197226046, 12.139583025996806, 12.152555018703634,
        12.166767745385942, 12.181191160227453, 12.195673777723181, 12.210213395318245, 12.224814030684954,
        12.237429548753669, 12.248340890354404, 12.259232921982026, 12.270146582115462, 12.281077564821393,
        12.291977726481038, 12.305103684455766, 12.32062873733137,  12.336258328769558, 12.351876269055062,
        12.367630447796165, 12.383406911297744, 12.399247287199751, 12.41517574175601,  12.427275157989877,
        12.439377956836037, 12.451512483455806, 12.463704432493227, 12.475912470378297, 12.488130332197976,
        12.500070151042825, 12.510985507189188, 12.521918069787388, 12.532834323359529, 12.543753441415653,
        12.554644231659925, 12.565572683770103, 12.576986578881803, 12.592691607619999, 12.60845047450555,
        12.624284943233782, 12.640184379412412, 12.65555065079626,  12.66647711704167,  12.677403252266677,
        12.688322269073204, 12.699246199779166, 12.710150013689551, 12.721080626710288, 12.73236343653772,
        12.7443497920323,   12.75636614164083,  12.768405124053226, 12.780459898911696, 12.79255729298378,
        12.80465674315178,  12.816800388098303, 12.828964553437395, 12.841157780114678, 12.853387714759485,
        12.865632278068386, 12.877913583639572, 12.891417362162976, 12.906101858118681, 12.920859056954129,
        12.935663838807049, 12.950523089951446, 12.965442914107749, 12.980428677289796, 12.995525982721944,
        13.01219984458931,  13.028923987042848, 13.045717329389962, 13.062568192622784, 13.079479529073902,
        13.096439967538423, 13.11345215525121,  13.129320524958173, 13.140288161150691, 13.15124952006698,
        13.162213925626414, 13.173174426218646};

    static const std::vector<double> _mag_disk_v_cgs = {
        2434.8078260999755,  4145.470221161596,   4676.8416205963,     4408.808386110136,   2668.318490456546,
        -1457.266730310404,  -9807.171722414942,  -23345.542824436357, -39278.39939064638,  -53514.126409285585,
        -67504.05272860208,  -73417.07854039887,  -63462.15021782927,  -58287.90740680579,  -79957.03422574908,
        -105357.36042429885, -131731.22310050315, -127607.8473242245,  -113042.08453514638, -106383.37120855036,
        -99255.15092819188,  -59449.246665965315, -105879.3416846583,  -19378.209065143463, 29240.616899765755,
        77090.28000218763,   129622.5845169876,   160764.70457949134,  188258.47943069966,  199457.60118073982,
        192470.2329865101,   198808.57686230345,  204787.88600874908,  195397.7469334996,   184557.65991280723,
        166674.9685856778,   146928.05847155023,  175236.56597781696,  145091.4577406559,   125064.22435707606,
        113176.0321072492,   118473.17526793401,  111861.41263671427,  99492.66621068348,   99233.05648330894,
        102301.42251642722,  103716.84789174056,  96074.93176785373,   96925.5678958469,    100410.96657613068,
        119869.26800397482,  139346.90207109146,  177349.3472697481,   218265.4973873424,   249418.66467228768,
        264622.4045573606,   261225.38365660864,  243908.86247960455,  213860.41743880627,  180732.55914244827,
        153100.69401072158,  149841.76339048793,  157961.47188496834,  197717.6636462083,   292309.5058012947,
        420954.4111322122,   433120.1648458809,   385202.8375060051,   267480.873364091,    179558.7917580421,
        77409.26855018508,   -81300.65265519287,  -315536.29098448524, -457934.98825503275, -491035.2284952871,
        -647891.9781361085,  -963027.8073070905,  -1403549.6111887563, -1865461.599522718,  -2247557.4057170595,
        -2590711.75280522,   -2748272.7628766852, -2549698.9394912627, -2190940.3907045266, -1690501.214105938,
        -953375.296698856,   64025.55856234424,   1263042.7507613103,  2424727.235622134,   3520335.5212549157,
        4767566.934896872,   5950586.368097785,   6975078.159263602,   7999984.2212709775,  8884176.287430128,
        9444270.465212654,   9975779.954927877,   10478152.395453723,  10897394.487107506,  11343149.912620818,
        11571965.507439766,  11671666.689974032,  11692518.322332306,  11758801.656981125,  11747754.434539655,
        11708260.6143114,    11573622.590805985,  11426418.351773398,  11235439.493816487,  11024023.274342855,
        10862871.916977914,  10697439.760916902,  10548164.167676538,  10383422.463018117,  10155849.680723839,
        9989588.982979715,   9858265.12620674,    9735226.686264869,   9639944.392707191,   9545352.550552104,
        9473131.333840994,   9393177.061420856,   9299137.580387842,   9182727.473910853,   9060379.485371573,
        8986777.36585528,    8873957.60667177,    8745119.374948125,   8661436.66495399,    8517684.682934362,
        8359295.131179789,   8238880.406567765,   8135726.96702054,    8080352.76453267,    8049696.722257591,
        7984794.290413956,   7889511.996856278,   7757221.508119675,   7619545.4984428575,  7465574.83566487,
        7373882.889400668,   7304147.297738889,   7240625.768700438,   7184146.843968422,   7112477.988379386,
        7009738.819673715,   6902166.491149902,   6838506.871830932,   6772085.446901593,   6662994.125292078,
        6525870.476737332,   6415260.162042114,   6323844.396338951,   6209919.914911292,   6089643.280579788,
        5999746.507962326,   5954867.166793854,   5890102.825230737,   5855165.984259588,   5861656.227443952,
        5795234.802514614,   5632840.632625005,   5575947.437051435,   5510492.644085726,   5406510.66285539,
        5277120.070009673,   5161124.23437424,    5052861.454447834,   4963517.042952445,   4939213.153581211,
        4918499.611503456,   4926785.028334558,   4831502.734776881,   4764805.129286505,   4687888.84303777,
        4670351.377411936,   4647704.571406923,   4600615.785750158,   4515552.17295084,    4437254.983896921,
        4360476.787928705,   4308831.023014832,   4240062.063316682,   4191178.104013178,   4164388.5895926133,
        4115642.720569628,   4040659.69824815,    3958772.161900754,   3882684.4173351293,  3795549.4503280357,
        3755088.998136152,   3700543.337331394,   3623903.2316436963,  3570462.2930830857,  3521025.9726575078,
        3481946.4232708076,  3448114.304543806,   3406825.310668812,   3350622.5664978335,  3296491.176534631,
        3244154.960218167,   3193890.098109479,   3146248.95133064,    3109240.7561517153,  3073337.283216938,
        3033014.9213055726,  2993383.0107967993,  2955546.273934765,   2918676.169036359,   2883325.0572236553,
        2844935.959239547,   2810275.298829435,   2773681.374492066,   2735292.276507958,   2698974.5327316257,
        2663209.1500773663,  2627443.7674231078,  2592783.1070129955,  2560193.8008106593,  2527880.67516936,
        2499295.9871020564,  2470573.2087542345,  2445164.5971388533,  2413680.0131806643,  2375152.8249160373,
        2337454.1783345216,  2302379.2470828546,  2266751.954709114,   2233196.016543149,   2200330.529779776,
        2168293.584699513,   2138189.9035465075,  2110295.666881796,   2083368.0621807128,  2058235.6311263684,
        2033793.6514746165,  2009075.4912618275,  1980766.983755561,   1953287.0179324043,  1927326.04519495,
        1899155.627969202,   1873747.0163538207,  1846957.5019332562,  1821134.61947632,    1795587.9175804208,
        1770869.757367632,   1745323.0554717325,  1721433.436942054,   1696577.1864487466,  1672963.7484801044,
        1649626.4910724992,  1626427.3239454124};

    class MagnetoDisk {
       public:
        constexpr static bool vel_dependent{true};
        // Type members
        template <typename Particles>
        static void add_acc_to(Particles const &particles, typename Particles::VectorArray &acceleration);

        template <typename Vec>
        static double disk_rho(Vec &r) {
            auto R = sqrt(r.x * r.x + r.y * r.y) / unit::cm;
            auto lgR = log10(R);
            auto lgRmin = _mag_disk_lgr_cgs[0];
            auto lgRmax = _mag_disk_lgr_cgs[_mag_disk_lgr_cgs.size() - 1];
            auto lgrholo = _mag_disk_lgrho_cgs[0];
            auto lgrhohi = _mag_disk_lgrho_cgs[_mag_disk_lgrho_cgs.size() - 1];

            if (lgR < lgRmin) {
                return pow(10, lgrholo) / 5.893333333333333e-07;
            } else if (lgR >= lgRmax) {
                return pow(10, lgrhohi) / 5.893333333333333e-07;
            } else {
                auto lgrho = interpolate(lgR, _mag_disk_lgr_cgs, _mag_disk_lgrho_cgs);
                return pow(10, lgrho) / 5.893333333333333e-07;
            }
        }

        template <typename Vec>
        static double disk_H(Vec &r) {
            auto R = sqrt(r.x * r.x + r.y * r.y) / unit::cm;
            auto lgR = log10(R);
            auto lgRmin = _mag_disk_lgr_cgs[0];
            auto lgRmax = _mag_disk_lgr_cgs[_mag_disk_lgr_cgs.size() - 1];
            auto lgHlo = _mag_disk_lgH_cgs[0];
            auto lgHhi = _mag_disk_lgH_cgs[_mag_disk_lgH_cgs.size() - 1];

            if (lgR < lgRmin) {
                return pow(10, lgHlo) / 1.5e13;
            } else if (lgR >= lgRmax) {
                return pow(10, lgHhi) / 1.5e13;
            } else {
                auto lgH = interpolate(lgR, _mag_disk_lgr_cgs, _mag_disk_lgH_cgs);
                return pow(10, lgH) / 1.5e13;
            }
        }

        template <typename Vec>
        static Vec disk_v(Vec &r) {
            auto rr = sqrt(r.x * r.x + r.y * r.y);
            auto R = rr / unit::cm;
            auto lgR = log10(R);
            auto lgRmin = _mag_disk_lgr_cgs[0];
            auto lgRmax = _mag_disk_lgr_cgs[_mag_disk_lgr_cgs.size() - 1];
            auto vlo = _mag_disk_v_cgs[0] * 3.357318203286629e-07;
            auto vhi = _mag_disk_v_cgs[_mag_disk_v_cgs.size() - 1] * 3.357318203286629e-07;

            if (lgR < lgRmin) {
                return Vec{-vlo * r.y / rr, vlo * r.x / rr, 0};
            } else if (lgR >= lgRmax) {
                return Vec{-vhi * r.y / rr, vhi * r.x / rr, 0};
            } else {
                auto v = interpolate(lgR, _mag_disk_lgr_cgs, _mag_disk_v_cgs) * 3.357318203286629e-07;
                return Vec{-v * r.y / rr, v * r.x / rr, 0};
            }
        }

        template <typename Scalar>
        static Scalar GDF_I(Scalar M) {
            auto lgM = log10(M);
            if (lgM < _GDF_lgM[0]) {
                return M / 3.0;
            } else if (lgM >= _GDF_lgM[_GDF_lgM.size() - 1]) {
                return 0;
            } else {
                return interpolate(lgM, _GDF_lgM, _GDF_I);
            }
        }
        template <typename Scalar>
        static double interpolate(Scalar x, std::vector<double> const &xarry, std::vector<double> const &yarray) {
            size_t idx = int((x - xarry[0]) / (xarry[1] - xarry[0]));
            double x0 = xarry[idx];
            double x1 = xarry[idx + 1];
            double y0 = yarray[idx];
            double y1 = yarray[idx + 1];
            return y0 + (x - x0) * (y1 - y0) / (x1 - x0);
        }
    };

    template <typename Particles>
    void MagnetoDisk::add_acc_to(const Particles &particles, typename Particles::VectorArray &acceleration) {
        size_t num = particles.number();
        auto const &p = particles.pos();
        auto const &v = particles.vel();
        auto const &m = particles.mass();
        auto const &R = particles.radius();

        for (size_t i = 1; i < num; ++i) {
            auto dr = p[i] - p[0];
            auto dv = v[i] - v[0];

            auto rho = disk_rho(dr);
            auto v_disk = disk_v(dr);
            auto H = disk_H(dr);
            auto v_rel = dv - v_disk;
            auto r = norm(dr);
            auto Omega = sqrt(consts::G * m[0] / (r * r * r));
            auto cs = Omega * H;

            auto v2 = dot(v_rel, v_rel);
            auto vabs = sqrt(v2);
            auto Mach = vabs / cs;

            auto rd = R[i];

            double I = GDF_I(Mach);

            double df = I * 4 * consts::pi * consts::G * consts::G * m[i] * m[i] / (cs * cs) * rho;
            double aeo = 4 * consts::pi * rd * rd * rho * v2;
            double f = df + aeo;

            acceleration[i] -= f * v_rel / vabs / m[i];
            acceleration[0] += f * v_rel / vabs / m[0];
        }
    }

}  // namespace hub::force
